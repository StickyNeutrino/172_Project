{"version":3,"file":"stream.m.js","sources":["../stream.js"],"sourcesContent":["const EventEmitter = require('events');\nconst END = '\\r\\n';\nconst END_LENGTH = 2;\n\nclass Stream extends EventEmitter {\n  constructor() {\n    super();\n    this.buffer = '';\n  }\n\n  parse(buffer) {\n    this.buffer += buffer.toString('utf8');\n    let index;\n    let json;\n\n    while ((index = this.buffer.indexOf(END)) > -1) {\n      json = this.buffer.slice(0, index);\n      this.buffer = this.buffer.slice(index + END_LENGTH);\n      if (json.length > 0) {\n        try {\n          json = JSON.parse(json);\n          this.emit(json.event || 'data', json);\n        } catch (error) {\n          error.source = json;\n          this.emit('error', error);\n        }\n      } else {\n        this.emit('ping');\n      }\n    }\n  }\n}\n\nmodule.exports = Stream;\n"],"names":["const","Stream","super","this","buffer","parse","index","json","toString","indexOf","slice","length","JSON","emit","event","error","source","require","module","exports"],"mappings":"AAAAA,IAIMC,cACJ,aACEC,aACAC,KAAKC,OAAS,mGAGhBC,eAAMD,OAEAE,EACAC,EAEJ,IAJAJ,KAAKC,QAAUA,EAAOI,SAAS,SAIvBF,EAAQH,KAAKC,OAAOK,QAdpB,UAcqC,GAG3C,GAFAF,OAAYH,OAAOM,MAAM,EAAGJ,QACvBF,YAAcA,OAAOM,MAAMJ,EAfnB,GAgBTC,EAAKI,OAAS,EAChB,IACEJ,EAAOK,KAAKP,MAAME,QACbM,KAAKN,EAAKO,OAAS,OAAQP,SACzBQ,GACPA,EAAMC,OAAST,OACVM,KAAK,QAASE,aAGhBF,KAAK,YA3BGI,QAAQ,WAiC7BC,OAAOC,QAAUlB"}